<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="少敲代码，多陪家人">
<meta property="og:type" content="website">
<meta property="og:title" content="seven-cm.blog">
<meta property="og:url" content="http://seven-cm.github.io/page/4/index.html">
<meta property="og:site_name" content="seven-cm.blog">
<meta property="og:description" content="少敲代码，多陪家人">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="seven-cm.blog">
<meta name="twitter:description" content="少敲代码，多陪家人">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://seven-cm.github.io/page/4/">





  <title> seven-cm.blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?fea19912a68edcd8dd8884f7fc44c677";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">seven-cm.blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/11/12/Ubuntu安装VirtualBox启动失败/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/Ubuntu安装VirtualBox启动失败/" itemprop="url">
                  Ubuntu安装VirtualBox启动失败
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-12T23:44:47+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在安装VirtualBox的日志中,总是提示<code>vboxdrv.sh: failed: modprobe vboxdrv failed.</code>,然后启动virtualBox的时候会提示<code>The VirtualBox Linux kernel driver (vboxdrv) is either not loaded..... run /sbin/vboxconfig as root</code>然而还是会失败.</p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>在搜索过程中,有提到需要将UEFI安全启动更改为OFF.抱着试一下的心态,重启电脑,将UEFI的安全模式为OFF模式.再执行/sbin/vboxconfig,居然成功了. 到此,virtualBox能正常启动了.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/11/12/docker-学习-建立容器-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/docker-学习-建立容器-1/" itemprop="url">
                  docker-学习-建立容器-1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-12T19:03:19+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>接上篇，我们已经把docker的环境搭建完毕。下面将按官网的教程进行相关的入门操手。官网的教程地址：<a href="https://docs.docker.com/get-started/part2/#prerequisites" target="_blank" rel="noopener">Get Started, Part 2: Containers</a></p>
<h2 id="Dockerfilew配置容器"><a href="#Dockerfilew配置容器" class="headerlink" title="Dockerfilew配置容器"></a>Dockerfilew配置容器</h2><ol>
<li>在宿主机上建立一个目录 如demo-docker</li>
<li>cd demo-docker</li>
<li>vi Dockerfile</li>
<li>在文件中录入如下内容：</li>
</ol>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use an official Python runtime as a parent image</span></span><br><span class="line"><span class="comment"># 我们使用官方提供的Python运行库作为父镜像</span></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">2.7</span>-slim</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the working directory to /app</span></span><br><span class="line"><span class="comment"># 设置工程目录路径 /app</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy the current directory contents into the container at /app</span></span><br><span class="line"><span class="comment"># 复制当前文件夹下的文件到工程路径 /app下</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> . /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install any needed packages specified in requirements.txt</span></span><br><span class="line"><span class="comment"># 安装在requirements.txt中列出的依赖包</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install --trusted-host pypi.python.org -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Make port 80 available to the world outside this container</span></span><br><span class="line"><span class="comment"># 对外暴露本容器80端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define environment variable</span></span><br><span class="line"><span class="comment"># 定义环境变量</span></span><br><span class="line"><span class="keyword">ENV</span> NAME World</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run app.py when the container launches</span></span><br><span class="line"><span class="comment"># 当容器运行时，执行的命令</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"python"</span>, <span class="string">"app.py"</span>]</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li><p>vi requirements.txt，并录入如下内容</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Flask</span></span><br><span class="line"><span class="attribute">Redis</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>vi app.py 并录入如下内容</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> Redis, RedisError</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># Connect to Redis</span></span><br><span class="line">redis = Redis(host=<span class="string">"redis"</span>, db=<span class="number">0</span>, socket_connect_timeout=<span class="number">2</span>, socket_timeout=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        visits = redis.incr(<span class="string">"counter"</span>)</span><br><span class="line">    <span class="keyword">except</span> RedisError:</span><br><span class="line">        visits = <span class="string">"&lt;i&gt;cannot connect to Redis, counter disabled&lt;/i&gt;"</span></span><br><span class="line"></span><br><span class="line">    html = <span class="string">"&lt;h3&gt;Hello &#123;name&#125;!&lt;/h3&gt;"</span> \</span><br><span class="line">           <span class="string">"&lt;b&gt;Hostname:&lt;/b&gt; &#123;hostname&#125;&lt;br/&gt;"</span> \</span><br><span class="line">           <span class="string">"&lt;b&gt;Visits:&lt;/b&gt; &#123;visits&#125;"</span></span><br><span class="line">    <span class="keyword">return</span> html.format(name=os.getenv(<span class="string">"NAME"</span>, <span class="string">"world"</span>), hostname=socket.gethostname(), visits=visits)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<ol start="7">
<li><p>最后在demo-docker中将有如下文件</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">app</span><span class="selector-class">.py</span>  <span class="selector-tag">Dockerfile</span>  <span class="selector-tag">requirements</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建docker镜像</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">docker</span> <span class="keyword">build </span>-t demo-docker .</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行完毕后，我们查看一下系统存在的docker镜像</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker image ls</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">demo-docker         latest              <span class="number">321</span>a0064dbe2        About an hour ago   <span class="number">148</span>MB</span><br><span class="line">python              <span class="number">2.7</span>-slim            b0259cf63993        <span class="number">7</span> days ago          <span class="number">138</span>MB</span><br><span class="line">hello-world         latest              <span class="number">725</span>dcfab7d63        <span class="number">8</span> days ago          <span class="number">1.84</span>kB</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行我们的镜像</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将本机的<span class="number">4000</span>端口映射到容器的<span class="number">80</span>端口</span><br><span class="line">docker run -p <span class="number">4000</span>:<span class="number">80</span> demo-docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>在后台运行</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p <span class="number">4000</span>:<span class="number">80</span> demo-docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动后我们将得到容器的ID信息，停止的时候，我们将会使用到此ID.另外我们还可以通过命令来查看相关的ID</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker container ls</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                  NAMES</span><br><span class="line"><span class="number">83</span>dd2473dc19        demo-docker         <span class="string">"python app.py"</span>     <span class="number">7</span> seconds ago       Up <span class="number">6</span> seconds        <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">4000</span>-&gt;<span class="number">80</span>/tcp   pensive_yalow</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止在后台运行的容器</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container stop <span class="number">83</span>dd2473dc19</span><br></pre></td></tr></table></figure>
</li>
<li><p>docker的一些常用命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">docker build -t friendlyname .  <span class="comment"># Create image using this directory's Dockerfile</span></span><br><span class="line">docker run -p 4000:80 friendlyname  <span class="comment"># Run "friendlyname" mapping port 4000 to 80</span></span><br><span class="line">docker run -d -p 4000:80 friendlyname         <span class="comment"># Same thing, but in detached mode</span></span><br><span class="line">docker container ls                                <span class="comment"># List all running containers</span></span><br><span class="line">docker container ls -a             <span class="comment"># List all containers, even those not running</span></span><br><span class="line">docker container <span class="keyword">stop</span> &lt;<span class="keyword">hash</span>&gt;           <span class="comment"># Gracefully stop the specified container</span></span><br><span class="line">docker <span class="keyword">container</span> <span class="keyword">kill</span> &lt;<span class="keyword">hash</span>&gt;         <span class="comment"># Force shutdown of the specified container</span></span><br><span class="line">docker <span class="keyword">container</span> rm &lt;<span class="keyword">hash</span>&gt;        <span class="comment"># Remove specified container from this machine</span></span><br><span class="line">docker <span class="keyword">container</span> rm $(docker <span class="keyword">container</span> ls -a -q)         <span class="comment"># Remove all containers</span></span><br><span class="line">docker image ls -a                             <span class="comment"># List all images on this machine</span></span><br><span class="line">docker image rm &lt;image <span class="keyword">id</span>&gt;            <span class="comment"># Remove specified image from this machine</span></span><br><span class="line">docker image rm $(docker image ls -a -q)   <span class="comment"># Remove all images from this machine</span></span><br><span class="line">docker login             <span class="comment"># Log in this CLI session using your Docker credentials</span></span><br><span class="line">docker tag &lt;image&gt; username/repository:tag  <span class="comment"># Tag &lt;image&gt; for upload to registry</span></span><br><span class="line">docker push username/repository:tag            <span class="comment"># Upload tagged image to registry</span></span><br><span class="line">docker run username/repository:tag                   <span class="comment"># Run image from a registry</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/11/12/docker-学习-安装-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/docker-学习-安装-1/" itemprop="url">
                  docker-学习-安装-1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-12T19:02:55+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在docker越来越热门的情况下，自己也打算了解docker的知识点，故有了此系列的教程。</p>
<h2 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Windows <span class="number">10</span></span><br><span class="line">VirtualBox</span><br><span class="line">CentOS <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>因没有多余的机器，而且又懒得在windows系统中安装多一个CentOS系统，故操作都是在虚拟机中操作。</p>
<h2 id="安装信息"><a href="#安装信息" class="headerlink" title="安装信息"></a>安装信息</h2><ol>
<li>先下载CentOS镜像<a href="http://mirrors.sohu.com/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1708.iso" target="_blank" rel="noopener">CentOS-7-x86_64-Minimal-1708.iso</a></li>
<li>安装CentOS，分区配置信息如下：</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left">目录</th>
<th style="text-align:right">大小</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/boot</td>
<td style="text-align:right">500M</td>
</tr>
<tr>
<td style="text-align:left">/swap</td>
<td style="text-align:right">1024M</td>
</tr>
<tr>
<td style="text-align:left">/</td>
<td style="text-align:right">5G</td>
</tr>
<tr>
<td style="text-align:left">/home</td>
<td style="text-align:right">余下</td>
</tr>
</tbody>
</table>
<h2 id="安装后执行以下操作"><a href="#安装后执行以下操作" class="headerlink" title="安装后执行以下操作"></a>安装后执行以下操作</h2><ol>
<li><p>更新时区、同步系统时间，因我没有在安装的时候选择时区故有次步骤</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="meta-keyword">/usr/</span>share<span class="meta-keyword">/zoneinfo/</span>Asia/Shanghai <span class="meta-keyword">/etc/</span>localtime</span><br><span class="line">yum install -y ntpdate</span><br><span class="line">ntpdate us.pool.ntp.org</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/selinux/config</span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line"><span class="comment">#SELINUX=enforcing</span></span><br><span class="line"><span class="attribute">SELINUX</span>=disabled</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of three two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line"><span class="attribute">SELINUXTYPE</span>=targeted</span><br><span class="line"><span class="comment"># 修改后需要重启系统</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装docker 【此方式存在问题，因为通过此方式安装的不是最新版本的docker；正确的安装方法请参考官网的安装方法：<a href="https://docs.docker.com/engine/installation/linux/docker-ce/centos/#prerequisites" target="_blank" rel="noopener">Get Docker CE for CentOS</a>】</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> -y docker</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><code>补充正确的安装方法：</code><br><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根据官网的介绍，我们将安装docker-ce版本</span></span><br><span class="line"><span class="attr">1、卸载旧版本：</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">remove docker \</span></span><br><span class="line">     <span class="meta">docker-common</span> <span class="string">\</span></span><br><span class="line">     <span class="meta">docker-selinux</span> <span class="string">\</span></span><br><span class="line">     <span class="attr">docker-engine</span></span><br><span class="line"><span class="comment"># The contents of /var/lib/docker/, including images, containers, volumes, and networks, are preserved</span></span><br><span class="line"><span class="attr">我们之前安装的docker的镜像、容器、网络配置等信息都不会被卸载</span></span><br><span class="line"><span class="attr">2、安装相关工具</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install -y yum-utils \</span></span><br><span class="line">     <span class="meta">device-mapper-persistent-data</span> <span class="string">\</span></span><br><span class="line">     <span class="attr">lvm2</span></span><br><span class="line"><span class="attr">3、配置稳定版本的库</span></span><br><span class="line"><span class="meta">yum-config-manager</span> <span class="string">\</span></span><br><span class="line">    <span class="meta">--add-repo</span> <span class="string">\</span></span><br><span class="line">    <span class="attr">https</span>:<span class="string">//download.docker.com/linux/centos/docker-ce.repo</span></span><br><span class="line"><span class="attr">4、安装最新版本的docker</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install docker-ce</span></span><br><span class="line"><span class="comment">#或者说安装指定版本</span></span><br><span class="line"><span class="comment">#yum list docker-ce --showduplicates | sort -r</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install &lt;FULLY-QUALIFIED-PACKAGE-NAME&gt;</span></span><br><span class="line"><span class="comment">#example</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install docker-ce-17.06.1.ce</span></span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>配置docker阿里云加速器</li>
</ol>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#通过修改daemon配置文件/etc/docker/daemon.json来使用加速器：</span></span><br><span class="line"></span><br><span class="line"><span class="string">"registry-mirrors"</span>: [<span class="string">"https://xxxx.mirror.aliyuncs.com"</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">#配置完成后</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
<p>如何获得加速器的链接，可以参考<a href="https://yq.aliyun.com/articles/29941" target="_blank" rel="noopener">Docker 镜像加速器</a></p>
<ol start="5">
<li>来到官网<a href="https://docs.docker.com/get-started/#prerequisites" target="_blank" rel="noopener">入门指南</a>根据入门步骤进行操作</li>
</ol>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br><span class="line"><span class="comment">#得到如下结果</span></span><br><span class="line">Unable <span class="built_in">to</span> find image <span class="string">'hello-world:latest'</span> locally</span><br><span class="line">Trying <span class="built_in">to</span> pull repository docker.io/library/hello-world ...</span><br><span class="line">latest: Pulling <span class="built_in">from</span> docker.io/library/hello-world</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>a0669468bf7: Pull complete</span><br><span class="line">Digest: sha256:<span class="number">0e06</span>ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fc</span><br><span class="line"></span><br><span class="line">Hello <span class="built_in">from</span> Docker!</span><br><span class="line">This message shows that your installation appears <span class="built_in">to</span> be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took <span class="keyword">the</span> following steps:</span><br><span class="line"> <span class="number">1.</span> The Docker client contacted <span class="keyword">the</span> Docker daemon.</span><br><span class="line"> <span class="number">2.</span> The Docker daemon pulled <span class="keyword">the</span> <span class="string">"hello-world"</span> image <span class="built_in">from</span> <span class="keyword">the</span> Docker Hub.</span><br><span class="line"> <span class="number">3.</span> The Docker daemon created <span class="keyword">a</span> <span class="built_in">new</span> container <span class="built_in">from</span> that image which runs <span class="keyword">the</span></span><br><span class="line">    executable that produces <span class="keyword">the</span> output you are currently reading.</span><br><span class="line"> <span class="number">4.</span> The Docker daemon streamed that output <span class="built_in">to</span> <span class="keyword">the</span> Docker client, which sent <span class="keyword">it</span></span><br><span class="line">    <span class="built_in">to</span> your terminal.</span><br><span class="line"></span><br><span class="line">To <span class="keyword">try</span> something more ambitious, you can run <span class="keyword">an</span> Ubuntu container <span class="keyword">with</span>:</span><br><span class="line"> $ docker run -<span class="keyword">it</span> ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, <span class="keyword">and</span> more <span class="keyword">with</span> <span class="keyword">a</span> free Docker ID:</span><br><span class="line"> <span class="keyword">https</span>://cloud.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples <span class="keyword">and</span> ideas, visit:</span><br><span class="line"> <span class="keyword">https</span>://docs.docker.com/engine/userguide/</span><br></pre></td></tr></table></figure>
<p>说明docker环境已经部署完成，而且能正确运行。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/11/10/WEB前端开发之-viewport/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/10/WEB前端开发之-viewport/" itemprop="url">
                  WEB前端开发之-viewport
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-10T08:35:24+08:00">
                2017-11-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我们做移动端的H5开发都会有用到viewport,那viewport究竟是什么呢?不着急,我们先看几篇文章:</p>
<ol>
<li><a href="http://weizhifeng.net/viewports.html" target="_blank" rel="noopener">两个viewport的故事</a></li>
<li><a href="http://www.css88.com/archives/5975" target="_blank" rel="noopener">说说移动前端中 viewport</a></li>
<li><a href="https://www.cnblogs.com/pigtail/archive/2013/03/15/2961631.html" target="_blank" rel="noopener">HTML meta viewport属性说明</a></li>
</ol>
<h2 id="viewport是什么"><a href="#viewport是什么" class="headerlink" title="viewport是什么?"></a>viewport是什么?</h2><p><code>手机浏览器是把页面放在一个虚拟的“窗口”（viewport）中，窗口可大于或小于手机的可视区域，一般手机默认viewport大于可视区域。这样不会破坏没有针对手机浏览器优化的网页的布局，用户可以通过平移和缩放来看网页的其他部分。</code></p>
<h2 id="viewport元素内容介绍"><a href="#viewport元素内容介绍" class="headerlink" title="viewport元素内容介绍"></a>viewport元素内容介绍</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta <span class="attribute">name</span>=”viewport” <span class="attribute">content</span>=”width=device-width, <span class="attribute">initial-scale</span>=1, <span class="attribute">maximum-scale</span>=1″&gt;</span><br></pre></td></tr></table></figure>
<p>我们从上面常见的viewport元素中,看看:</p>
<ol>
<li>width：控制 viewport 的大小，可以指定的一个值，如果 600，或者特殊的值，如 device-width 为设备的宽度（单位为缩放为 100% 时的 CSS 的像素）。</li>
<li>height：和 width 相对应，指定高度。</li>
<li>initial-scale：初始缩放比例，也即是当页面第一次 load 的时候缩放比例。</li>
<li>maximum-scale：允许用户缩放到的最大比例。</li>
<li>minimum-scale：允许用户缩放到的最小比例。</li>
<li>user-scalable：用户是否可以手动缩放。</li>
<li>有关viewport兼容的写法如下:<br><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no&quot; /&gt;</code></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/11/02/tomcat安装脚本/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/02/tomcat安装脚本/" itemprop="url">
                  tomcat安装脚本
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-02T20:31:16+08:00">
                2017-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>….</p>
<h2 id="脚本如下"><a href="#脚本如下" class="headerlink" title="脚本如下"></a>脚本如下</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> init tomcat7.X</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 20170417</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查是否为root用户，脚本必须在root权限下运行</span></span><br><span class="line">if [[ "$(whoami)" != "root" ]]; then</span><br><span class="line">    echo "please run this script as root !" &gt;&amp;2</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line">echo -e "\033[31m the script only Support CentOS_6 x86_64 \033[0m"</span><br><span class="line">echo -e "\033[31m system initialization script, Please Seriously. press ctrl+C to cancel \033[0m"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查是否为64位系统，这个脚本只支持64位脚本</span></span><br><span class="line">platform=`uname -i`</span><br><span class="line">if [ $platform != "x86_64" ];then</span><br><span class="line">    echo "this script is only for 64bit Operating System !"</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line">+---------------------------------------+</span><br><span class="line">|   your system is CentOS 6 x86_64      |</span><br><span class="line">|           start tomcat7 init          |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">EOF</span><br><span class="line">sleep 1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">配置tomcat安装的路径及版本</span></span><br><span class="line">tomcatPathVersion="/opt/tomcat7"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载tomcat openssl 配置tomcat apr</span></span><br><span class="line">download_tomcat()&#123;</span><br><span class="line">  yum install -y perl gcc zlib-devel</span><br><span class="line">  wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz</span><br><span class="line">  wget https://www.openssl.org/source/openssl-1.1.0c.tar.gz</span><br><span class="line">  tar zxvf openssl-1.1.0c.tar.gz</span><br><span class="line">  cd openssl-1.1.0c</span><br><span class="line">  ./config --prefix=/usr/local/ssl-1.1.0c shared zlib</span><br><span class="line">  make &amp;&amp; make install</span><br><span class="line">  cd ../</span><br><span class="line">  wget http://mirrors.cnnic.cn/apache//apr/apr-1.5.2.tar.gz</span><br><span class="line">  wget http://mirrors.cnnic.cn/apache//apr/apr-util-1.5.4.tar.gz</span><br><span class="line">  wget http://mirrors.cnnic.cn/apache//apr/apr-iconv-1.2.1.tar.gz</span><br><span class="line">  tar zxvf apache-tomcat-7.0.77.tar.gz</span><br><span class="line">  cd apache-tomcat-7.0.77</span><br><span class="line">  mkdir -p $tomcatPathVersion/bin</span><br><span class="line">  mkdir -p $tomcatPathVersion/lib</span><br><span class="line">  cp -R bin/* $tomcatPathVersion/bin</span><br><span class="line">  cp -R lib/* $tomcatPathVersion/lib</span><br><span class="line">  cd ../</span><br><span class="line">  tar zxvf apr-1.5.2.tar.gz</span><br><span class="line">  cd apr-1.5.2</span><br><span class="line">  ./configure --prefix=$tomcatPathVersion/apr</span><br><span class="line">  make &amp;&amp; make install</span><br><span class="line">  cd ../</span><br><span class="line">  tar zxvf apr-iconv-1.2.1.tar.gz</span><br><span class="line">  cd apr-iconv-1.2.1</span><br><span class="line">  ./configure --prefix=$tomcatPathVersion/apr-iconv --with-apr=$tomcatPathVersion/apr</span><br><span class="line">  make &amp;&amp; make install</span><br><span class="line">  cd ../</span><br><span class="line">  tar zxvf apr-util-1.5.4.tar.gz</span><br><span class="line">  cd apr-util-1.5.4</span><br><span class="line">  ./configure --prefix=$tomcatPathVersion/apr-util --with-apr=$tomcatPathVersion/apr --with-apr-iconv=$tomcatPathVersion/apr-iconv/bin/apriconv</span><br><span class="line">  make &amp;&amp; make install</span><br><span class="line">  cd $tomcatPathVersion/bin/</span><br><span class="line">  tar zxvf tomcat-native.tar.gz</span><br><span class="line">  cd $tomcatPathVersion/bin/tomcat-native-1.2.12-src/native</span><br><span class="line">  ./configure --prefix=$tomcatPathVersion/apr --with-ssl=/usr/local/ssl-1.1.0c --with-apr=$tomcatPathVersion/apr --with-java-home=$JAVA_HOME</span><br><span class="line">  make &amp;&amp; make install</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">done</span></span></span><br><span class="line">done_ok()&#123;</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line">  +-------------------------------------------------+</span><br><span class="line">  |       tomcat7 optimizer is done                 |</span><br><span class="line">  +-------------------------------------------------+</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> main</span></span><br><span class="line">main()&#123;</span><br><span class="line">    download_tomcat</span><br><span class="line">    done_ok</span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/10/16/CentOS-搭建WordPress环境-nginx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/16/CentOS-搭建WordPress环境-nginx/" itemprop="url">
                  CentOS 搭建WordPress环境(nginx)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-16T23:26:14+08:00">
                2017-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前一直都是在用阿里云提供的WordPress镜像.最近需要在阿里云之外的服务器上搭建一套WordPress环境.环境信息如下:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">系统<span class="selector-pseudo">:CentOS</span> 6<span class="selector-class">.5</span></span><br><span class="line">数据库<span class="selector-pseudo">:MySQL(</span>已安装)</span><br><span class="line"><span class="selector-tag">Nginx</span>:已搭建</span><br></pre></td></tr></table></figure></p>
<p>故,只需要搭建php环境即可</p>
<h2 id="安装php"><a href="#安装php" class="headerlink" title="安装php"></a>安装php</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> -y php php-fpm</span><br></pre></td></tr></table></figure>
<h2 id="安装PHP组件"><a href="#安装PHP组件" class="headerlink" title="安装PHP组件"></a>安装PHP组件</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php-mysql php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-<span class="keyword">xml</span> <span class="title">php-xmlrpc</span> php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt</span><br></pre></td></tr></table></figure>
<p><code>然而</code>报<code>mysql-libs-*</code> conflicts with file <code>MySQL-server-*</code></p>
<p>解决方法:<br><code>安装:MySQL-shared-compat-*组件即可</code>;后续继续安装PHP组件</p>
<h2 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">80</span> ;</span><br><span class="line">        <span class="attribute">server_name</span> www.test.com;</span><br><span class="line">        <span class="attribute">error_page</span> <span class="number">404</span> <span class="number">502</span> = <span class="variable">@fetch</span>;</span><br><span class="line">        <span class="attribute">location</span>  <span class="variable">@fetch</span> &#123;</span><br><span class="line">           <span class="attribute">default_type</span> application/json;</span><br><span class="line">           <span class="attribute">return</span> <span class="number">200</span> <span class="string">'&#123;"result_Code":110,"result":110,"state":false,"msg":"service unavailable..."&#125;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attribute">location</span>  <span class="regexp">~ \.(js|css|gif|jpg|jpeg|png|svg|woff2|woff|ttf)$</span> &#123;</span><br><span class="line">                <span class="attribute">root</span> /data/mall/wwwroot/www.test.com;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~ /</span> &#123;</span><br><span class="line">                        <span class="attribute">root</span> /data/mall/wwwroot/www.test.com;</span><br><span class="line">                        <span class="attribute">fastcgi_pass</span> <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">                        <span class="attribute">fastcgi_index</span> index.php;</span><br><span class="line">                        <span class="attribute">fastcgi_param</span> SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">                        <span class="attribute">include</span> fastcgi_params;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="下载WordPress"><a href="#下载WordPress" class="headerlink" title="下载WordPress"></a>下载WordPress</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">https:</span><span class="comment">//cn.wordpress.org/wordpress-4.8.1-zh_CN.tar.gz</span></span><br></pre></td></tr></table></figure>
<p>解压至:/data/mall/wwwroot/<a href="http://www.test.com" target="_blank" rel="noopener">www.test.com</a></p>
<h2 id="您的PHP似乎没有安装运行WordPress所必需的MySQL扩展"><a href="#您的PHP似乎没有安装运行WordPress所必需的MySQL扩展" class="headerlink" title="您的PHP似乎没有安装运行WordPress所必需的MySQL扩展"></a>您的PHP似乎没有安装运行WordPress所必需的MySQL扩展</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>php.ini</span><br><span class="line"><span class="comment">#设置 extension_dir</span></span><br><span class="line">extension_dir = “<span class="regexp">/usr/</span>lib64<span class="regexp">/php/m</span>odules”</span><br></pre></td></tr></table></figure>
<h2 id="配置php-fpm运行用户"><a href="#配置php-fpm运行用户" class="headerlink" title="配置php-fpm运行用户"></a>配置php-fpm运行用户</h2><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="meta-keyword">/etc/</span>php-fpm.d/www.conf</span><br><span class="line"><span class="meta">#修改相关的group user即可</span></span><br></pre></td></tr></table></figure>
<p>最后往MySQL中增加网站的数据库以及用户后启动php-fpm即可.</p>
<p>#访问出现403<br>此问题一般是wordpress的根目录权限没有设置为755造成；需检查是否被错误配置为700</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/10/07/Spring-Schedule运行几次后不再执行的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/07/Spring-Schedule运行几次后不再执行的问题/" itemprop="url">
                  Spring Schedule运行几次后不再执行的问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-07T23:44:17+08:00">
                2017-10-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在10.1放假前夕,我们项目中的定时任务总是在执行一段时间后就僵死掉,定时任务不再执行.检查相关的日志也没发现相关的错误日志.</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>搜索一下,发现有此篇文章<a href="http://www.cnblogs.com/zj0208/p/7018098.html" target="_blank" rel="noopener">Spring task定时任务执行一段时间后莫名其妙停止的问题-迷失之路</a>有涉及到相关的问题.<br>里面有提到:</p>
<p><code>如果使用了Http方法,一定要在http请求的代码中设置超时时间.</code></p>
<p>仔细检查了一下,原来真的在http请求中没有设置相关的超时时间.修改代码发布后,定时任务正常.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置连接主机超时（50s）</span></span><br><span class="line">connection.setConnectTimeout(<span class="number">50</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置从主机读取数据超时（50s）</span></span><br><span class="line">connection.setReadTimeout(<span class="number">50</span> * <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/09/05/mysql-binary-log的清理与还原命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/05/mysql-binary-log的清理与还原命令/" itemprop="url">
                  mysql-binary-log的清理与还原命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-05T22:21:57+08:00">
                2017-09-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>随着应用的业务量越来越大,产生的binary log 的日志越来越大.下面来介绍与MySQL日志相关的命令.</p>
<h2 id="MySQL日志相关命令"><a href="#MySQL日志相关命令" class="headerlink" title="MySQL日志相关命令"></a>MySQL日志相关命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">--查看当前主库日志状态</span><br><span class="line">show master status;</span><br><span class="line"></span><br><span class="line">--查看主库的日志列表</span><br><span class="line">show master logs;</span><br><span class="line"></span><br><span class="line">--查看系统log配置信息</span><br><span class="line">show variables like &apos;log_%&apos;;</span><br><span class="line"></span><br><span class="line">show binlog events in &apos;webser.000143&apos; limit 0,20 ;</span><br><span class="line"></span><br><span class="line">--查看从库日志状态</span><br><span class="line">show slave status;</span><br><span class="line"></span><br><span class="line">--查看binlog日志列表</span><br><span class="line">show binary logs;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 清理编号000015之前的所有日志</span><br><span class="line">purge master logs to &apos;mysql-bin.000015&apos;;</span><br><span class="line"></span><br><span class="line">-- 该命令将清理所有二进制日志，新日志的编号从&quot;000001&quot;开始</span><br><span class="line">reset master;</span><br><span class="line"></span><br><span class="line">-- 清理在2010-05-22 01:00:00之前的日志</span><br><span class="line">purge master logs before &apos;2010-05-22 01:00:00&apos;;</span><br><span class="line"></span><br><span class="line">--产生新的日志文件</span><br><span class="line">flush logs;</span><br></pre></td></tr></table></figure>
<h2 id="另外有关日志恢复的-可参考以下博客"><a href="#另外有关日志恢复的-可参考以下博客" class="headerlink" title="另外有关日志恢复的,可参考以下博客"></a>另外有关日志恢复的,可参考以下博客</h2><p><a href="http://www.cnblogs.com/kevingrace/p/5907254.html" target="_blank" rel="noopener">Mysql之binlog日志说明及利用binlog日志恢复数据操作记录-散尽浮华</a></p>
<p>另外需要注意的是:</p>
<ol>
<li>如果是使用binary log来恢复日志,则需要保持日志的完整性;如果日志被清理过,则有很大可能不能通过binary log来恢复数据.</li>
</ol>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">如</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> a <span class="keyword">values</span>(b);</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> a;</span><br><span class="line"></span><br><span class="line">如果<span class="keyword">insert</span>的数据日志被清理掉,只剩下<span class="keyword">delete</span> <span class="keyword">from</span> a的日志;则是不能从binary 日志中恢复数据.</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/08/29/export-Runnable-JAR-File-UnsatisfiedLinkError/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/29/export-Runnable-JAR-File-UnsatisfiedLinkError/" itemprop="url">
                  export Runnable JAR File UnsatisfiedLinkError
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T19:49:55+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天在使用<a href="http://jnetpcap.com/download" target="_blank" rel="noopener">http://jnetpcap.com/download</a> 进行网卡监听；直接导出可运行java文件会引发java.lang.UnsatisfiedLinkError: com.slytechs.library的异常。</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>在网上搜了，只有这个是符合我的要求<code>JAVA打成JAR包后dll的调用方法</code><a href="http://blog.csdn.net/bupt073114/article/details/52083768" target="_blank" rel="noopener">http://blog.csdn.net/bupt073114/article/details/52083768</a><br>参照文章中的说法，得出以下经验：<br><code>配置方法</code></p>
<ol>
<li>在package中新建lib包，然后放入相关的.dll或.so等文件</li>
<li>右键工程properties,在source中编辑Native library location指向至src/lib文件夹即可</li>
<li>在main中添加静态块<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			InputStream in = ClassicPcapExample<span class="class">.<span class="keyword">class</span></span></span><br><span class="line">					.getResourceAsStream("/lib/jnetpcap.dll");</span><br><span class="line"></span><br><span class="line">			System.out.println(<span class="string">"ClassicPcapExample.class.getClass()"</span> + in);</span><br><span class="line"></span><br><span class="line">			File ffile = <span class="keyword">new</span> File(<span class="string">""</span>);</span><br><span class="line">			String filePath = <span class="keyword">null</span>;</span><br><span class="line">			filePath = ffile.getAbsolutePath() + File.separator + <span class="string">"jnetpcap.dll"</span>;</span><br><span class="line">			System.out.println(<span class="string">"filePath jnetpcap.dll is "</span> + filePath);</span><br><span class="line">			File dll = <span class="keyword">new</span> File(filePath);</span><br><span class="line">			FileOutputStream out = <span class="keyword">new</span> FileOutputStream(dll);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> i;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">while</span> ((i = in.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line">					out.write(buf, <span class="number">0</span>, i);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				in.close();</span><br><span class="line">				out.close();</span><br><span class="line">			&#125;</span><br><span class="line">			System.load(dll.getAbsolutePath());<span class="comment">//</span></span><br><span class="line">			dll.deleteOnExit();</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			System.err.println(<span class="string">"load jni error!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://seven-cm.github.io/2017/08/23/阿里云CentOS6-8配置tomcat所遇到的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-cm">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seven-cm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/23/阿里云CentOS6-8配置tomcat所遇到的问题/" itemprop="url">
                  阿里云CentOS6.8配置tomcat所遇到的问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-23T20:11:10+08:00">
                2017-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天对新购的阿里云ecs进行环境配置的时候，出现了比较奇怪的问题：JSVC启动tomcat后只有一个进程；而且日志会输出以下的内容:<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># A fatal error has been detected by the Java Runtime Environment:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#  SIGBUS (0x7) at pc=0x00007f431508a441, pid=14586, tid=139926181689088</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># JRE version:  (7.0_80-b15) (build )</span></span><br><span class="line"><span class="meta"># Java VM: Java HotSpot(TM) 64-Bit Server VM (24.80-b11 mixed mode linux-amd64 compressed oops)</span></span><br><span class="line"><span class="meta"># Problematic frame:</span></span><br><span class="line"><span class="meta"># j  java.lang.Object.&lt;clinit&gt;()V+0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># An error report file with more information is saved as:</span></span><br><span class="line"><span class="meta"># /tmp/hs_err_pid14586.log</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"># If you would like to submit a bug report, please visit:</span></span><br><span class="line"><span class="meta">#   http://bugreport.java.com/bugreport/crash.jsp</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure></p>
<p>而且tomcat根本就没有正常的日志输出。心想，这是什么问题？会不会是环境变量的问题？然后又重新配置了java环境。但是还是会有这样的情况出现。</p>
<h2 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h2><p>先把问题提交工单，然后通过搜索引擎查询到<code>JVM crashes after updating to kernel with patch for Stack Guard flaw (CVE-2017-1000364)</code><a href="https://access.redhat.com/solutions/3091371" target="_blank" rel="noopener">https://access.redhat.com/solutions/3091371</a>;　此时心想会不会是内核跟新后的问题？然后把查找到的链接也提到工单里面去。</p>
<p><code>无奈</code>阿里云的效率还是太慢了。自己也没有认真去研究，只是简单地把系统版本从CentOS 6.8 换回了CentOS 6.5　然后重复走一次脚本；发现问题不存在了。看来确实是内核存在问题。</p>
<h2 id="最终解决方案"><a href="#最终解决方案" class="headerlink" title="最终解决方案"></a>最终解决方案</h2><p>后续过了１个小时，阿里才有反馈，其中有提到说增加参数配置，能临时解决此问题。<code>JVM crashes occurring after upgrading to a kernel with the fix for Stack Clash</code><br><a href="https://www.cloudlinux.com/cloudlinux-os-blog/entry/jvm-crashes-occurring-after-upgrading-to-a-kernel-with-the-fix-for-stack-clash" target="_blank" rel="noopener">https://www.cloudlinux.com/cloudlinux-os-blog/entry/jvm-crashes-occurring-after-upgrading-to-a-kernel-with-the-fix-for-stack-clash</a></p>
<h2 id="心得"><a href="#心得" class="headerlink" title="心得"></a>心得</h2><p>后续还是要提工单，然后等待解决方案；另外还要多留意一下内核升级后所引发的问题，以及多多关注阿里云上的博客;<a href="https://yq.aliyun.com/articles/145438?spm=5176.8091938.0.0.qtg7rk" target="_blank" rel="noopener">https://yq.aliyun.com/articles/145438?spm=5176.8091938.0.0.qtg7rk</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="seven-cm">
          <p class="site-author-name" itemprop="name">seven-cm</p>
           
              <p class="site-description motion-element" itemprop="description">少敲代码，多陪家人</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">80</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">100</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/seven-cm" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">seven-cm</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  







  





  

  

  

  

  

</body>
</html>
